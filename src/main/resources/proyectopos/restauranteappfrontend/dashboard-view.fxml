<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Priority?>
<?import javafx.scene.layout.TilePane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/20.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="proyectopos.restauranteappfrontend.controllers.DashboardController"
            prefHeight="750.0" prefWidth="1280.0"
            styleClass="background">

    <top>
        <VBox style="-fx-background-color: #1f2937; -fx-padding: 10; -fx-border-color: #4b5563 transparent transparent transparent; -fx-border-width: 1;">
            <Label text="PANEL PRINCIPAL" styleClass="h1" />
            <Label fx:id="infoLabel" text="Bienvenido" styleClass="lbl-info"/>
        </VBox>
    </top>

    <center>
        <HBox spacing="10" style="-fx-padding: 10;">

            <VBox spacing="10" HBox.hgrow="ALWAYS"> 
                <VBox styleClass="card" VBox.vgrow="ALWAYS"> <Label text="Plano de Mesas" styleClass="h3"/>
                    <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" prefHeight="600"> 
                        <content>
                            <TilePane fx:id="mesasContainer" hgap="10" vgap="10" prefColumns="6">
                                <padding><Insets top="10"/></padding>
                                <Label text="Cargando mesas..." />
                            </TilePane>
                        </content>
                    </ScrollPane>
                </VBox>

                </VBox>

            <Separator orientation="VERTICAL" />

            <VBox fx:id="gestionPedidoPane" spacing="10" HBox.hgrow="NEVER" prefWidth="700" 
                  visible="false" managed="false">

                <HBox spacing="10" VBox.vgrow="ALWAYS">
                    <VBox spacing="5" HBox.hgrow="NEVER" prefWidth="250">
                        <Label text="Categorías" styleClass="h3"/>
                        <ListView fx:id="categoriasListView" VBox.vgrow="SOMETIMES">
                            <placeholder><Label text="Cargando..."/></placeholder>
                        </ListView>
                        <Label text="Subcategorías" styleClass="h3"/>
                        <ListView fx:id="subCategoriasListView" VBox.vgrow="ALWAYS">
                            <placeholder><Label text="Seleccione categoría"/></placeholder>
                        </ListView>
                    </VBox>
                    <VBox spacing="5" HBox.hgrow="ALWAYS">
                        <Label text="Productos" styleClass="h3"/>
                        <TableView fx:id="productosTableView" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="nombreProductoCol" text="Nombre" prefWidth="200"/>
                                <TableColumn fx:id="precioProductoCol" text="Precio" prefWidth="80"/>
                                <TableColumn fx:id="categoriaProductoCol" text="Categoría" prefWidth="120"/>
                            </columns>
                            <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
                            <placeholder><Label text="Seleccione subcategoría"/></placeholder>
                        </TableView>
                    </VBox>
                </HBox>

                <VBox spacing="10" styleClass="card"> 
                    <Label text="Pedido Actual" styleClass="h2"/>
                    <Label fx:id="mesaSeleccionadaLabel" text="Mesa: (Ninguna)" style="-fx-font-weight: bold;"/>

                    <TableView fx:id="pedidoActualTableView" prefHeight="200" VBox.vgrow="NEVER">
                        <columns>
                            <TableColumn fx:id="pedidoNombreCol" text="Producto" prefWidth="180"/>
                            <TableColumn fx:id="pedidoCantidadCol" text="Cant." prefWidth="50"/>
                            <TableColumn fx:id="pedidoPrecioCol" text="P. Unit." prefWidth="70"/>
                            <TableColumn fx:id="pedidoSubtotalCol" text="Subtotal" prefWidth="80"/>
                        </columns>
                        <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
                        <placeholder><Label text="Añada productos (doble clic)"/></placeholder>
                    </TableView>

                    <VBox spacing="5" style="-fx-padding: 10 0 0 0;">
                        <Separator/>
                        <HBox alignment="CENTER_RIGHT">
                            <Label text="Subtotal: " style="-fx-text-fill: #9ca3af;"/>
                            <Label fx:id="subTotalPedidoLabel" text="S/ 0.00" style="-fx-font-weight: bold; -fx-text-fill: #9ca3af;"/>
                        </HBox>
                        <HBox alignment="CENTER_RIGHT">
                            <Label text="IGV (18%): " style="-fx-text-fill: #9ca3af;"/>
                            <Label fx:id="igvPedidoLabel" text="S/ 0.00" style="-fx-font-weight: bold; -fx-text-fill: #9ca3af;"/>
                        </HBox>
                        <HBox alignment="CENTER_RIGHT">
                            <Label text="Total: " styleClass="h3"/>
                            <Label fx:id="totalPedidoLabel" text="S/ 0.00" styleClass="h3" style="-fx-text-fill: -fx-accent;"/>
                        </HBox>
                    </VBox>

                    <Button fx:id="crearPedidoButton" text="Enviar Pedido a Cocina" onAction="#handleEnviarPedido" styleClass="btn-primary" maxWidth="Infinity" prefHeight="40"/>
                </VBox>
            </VBox>

        </HBox>
    </center>

</BorderPane>